<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Cloud Inventory â€” Reports</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  body {
    background-image: url('https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=3840&q=80');
    background-size: cover;
    background-position: center;
  }
  .card-white { background-color: rgba(255,255,255,0.9); color: #1f2937; }
  .btn-blue { background-color: #1d4ed8; color:white; padding:0.5rem 1rem; border-radius:0.5rem; }
  .btn-blue:hover { background-color:#1e40af; }

  /* Sidebar Styles */
  #sidebar {
    position: fixed;
    top: 0;
    left: -230px;
    width: 230px;
    height: 100vh;
    background: rgba(255,255,255,0.85);
    padding: 1rem;
    border-radius: 0 1rem 1rem 0;
    transition: left .3s ease;
    z-index: 999;
    backdrop-filter: blur(8px);
  }
  #sidebar.show { left: 0; }
  #sidebarTrigger {
    position: fixed;
    top: 0;
    left: 0;
    width: 20px;
    height: 100vh;
    z-index: 998;
  }
  .menu-btn {
    width: 100%;
    text-align: left;
    margin-bottom: .5rem;
    padding: .5rem 1rem;
    border-radius: .5rem;
    color: white;
    font-weight: 500;
    transition: .2s;
  }
  .btn-red-sidebar { background-color:#e50914; }
  .btn-red-sidebar:hover { background-color:#b00610; }
</style>
</head>

<body class="min-h-screen p-6 text-white">

<!-- SIDEBAR TRIGGER -->
<div id="sidebarTrigger"></div>

<!-- SIDEBAR -->
<aside id="sidebar">
  <h1 class="text-2xl font-bold mb-6 text-gray-900">CloudInventory</h1>

  <a href="../index.html"><button class="menu-btn btn-blue">Home</button></a>
  <a href="dashboard.html"><button class="menu-btn btn-blue">Dashboard</button></a>
  <a href="sales.html"><button class="menu-btn btn-blue">Sales</button></a>
  <a href="purchase.html"><button class="menu-btn btn-blue">Purchases</button></a>
  <a href="stock.html"><button class="menu-btn btn-blue">Stock</button></a>
  <a href="report.html"><button class="menu-btn btn-blue">Report</button></a>
  <a href="admin.html"><button class="menu-btn btn-red-sidebar">Admin</button></a>
</aside>

<!-- PAGE CONTENT -->
<div class="ml-0 max-w-7xl mx-auto">

<h1 class="text-3xl font-bold mb-6">Reports</h1>

<!-- REPORT PRINTING MENU -->
<div class="card-white p-6 rounded-xl shadow-md mb-8">

  <h2 class="text-2xl font-bold mb-6 text-gray-800 text-center">Report Printing Menu</h2>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">

    <!-- PURCHASE REPORT -->
    <div class="p-5 bg-white/70 rounded-xl shadow border">
      <h3 class="text-xl font-semibold mb-4 text-gray-900 text-center">Purchase Report</h3>

      <label class="block mb-1 font-medium">Supplier / Vendor <span class="text-red-600">*</span></label>
      <input type="text" id="purchaseSupplier" placeholder="Enter Supplier / Vendor"
        class="w-full p-3 rounded-lg border mb-4 shadow-sm" required />

      <label class="block mb-1 font-medium">Report Type</label>
      <select id="purchaseType"
        class="w-full p-3 rounded-lg border shadow-sm mb-4">
        <option value="day">Day</option>
        <option value="month">Month</option>
      </select>

      <!-- Date for purchase (shown only if Day selected) -->
      <div id="purchaseDateBox" class="hidden">
        <label class="block mb-1 font-medium">Select Date</label>
        <input type="date" id="purchaseDate"
          class="w-full p-3 rounded-lg border shadow-sm" />
      </div>
    </div>


    <!-- SALES REPORT -->
    <div class="p-5 bg-white/70 rounded-xl shadow border">
      <h3 class="text-xl font-semibold mb-4 text-gray-900 text-center">Sales Report</h3>

      <label class="block mb-1 font-medium">Customer Name (Optional)</label>
      <input type="text" id="salesCustomer" placeholder="Optional"
        class="w-full p-3 rounded-lg border mb-4 shadow-sm" />

      <label class="block mb-1 font-medium">Report Type</label>
      <select id="salesType"
        class="w-full p-3 rounded-lg border shadow-sm mb-4">
        <option value="day">Day</option>
        <option value="week">Week</option>
        <option value="month">Month</option>
      </select>

      <!-- Date for sales (shown only if Day selected) -->
      <div id="salesDateBox" class="hidden">
        <label class="block mb-1 font-medium">Select Date</label>
        <input type="date" id="salesDate"
          class="w-full p-3 rounded-lg border shadow-sm" />
      </div>
    </div>

  </div>
</div>

</div>

<!-- SIDEBAR SCRIPT -->
<script>
  const sidebar = document.getElementById("sidebar");
  const trigger = document.getElementById("sidebarTrigger");

  trigger.addEventListener("mouseenter", () => { sidebar.classList.add("show"); });
  sidebar.addEventListener("mouseleave", () => { sidebar.classList.remove("show"); });
</script>

<!-- REPORT PAGE SCRIPT -->
<script>
// Common toggle function
function toggleDate(typeSelectId, dateBoxId) {
  const type = document.getElementById(typeSelectId).value;
  const box = document.getElementById(dateBoxId);

  if (type === "day") {
    box.classList.remove("hidden");
  } else {
    box.classList.add("hidden");
  }
}

// Apply events
document.getElementById("purchaseType").addEventListener("change", () => {
  toggleDate("purchaseType", "purchaseDateBox");
});

document.getElementById("salesType").addEventListener("change", () => {
  toggleDate("salesType", "salesDateBox");
});

let sales = JSON.parse(localStorage.getItem("salesData") || "[]");
let purchase = JSON.parse(localStorage.getItem("purchaseData") || "[]");

function formatRs(n){ return 'Rs.' + Number(n).toLocaleString(); }

function calcTotals(data){
  let total = data.reduce((sum, x)=> sum + Number(x.total || 0), 0);
  let paid  = data.reduce((sum, x)=> sum + Number(x.amountPaid || x.paid || 0), 0);
  let bal   = data.reduce((sum, x)=> sum + Number(x.balance || 0), 0);
  return {total,paid,bal};
}

function renderReport(){
  const salesToday = calcTotals(sales);
  const purchaseToday = calcTotals(purchase);

  let html = `
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

    <div class="card-white p-6 rounded-xl shadow-md">
      <h2 class="text-xl font-bold mb-4">Sales Summary</h2>
      <p class="mb-2"><strong>Total Sales:</strong> ${formatRs(salesToday.total)}</p>
      <p class="mb-2"><strong>Amount Received:</strong> ${formatRs(salesToday.paid)}</p>
      <p><strong>Pending:</strong> ${formatRs(salesToday.bal)}</p>
    </div>

    <div class="card-white p-6 rounded-xl shadow-md">
      <h2 class="text-xl font-bold mb-4">Purchase Summary</h2>
      <p class="mb-2"><strong>Total Purchases:</strong> ${formatRs(purchaseToday.total)}</p>
      <p class="mb-2"><strong>Paid:</strong> ${formatRs(purchaseToday.paid)}</p>
      <p><strong>Pending:</strong> ${formatRs(purchaseToday.bal)}</p>
    </div>

  </div>
  `;

  document.getElementById("content").innerHTML = html;
}

renderReport();
</script>

</body>
</html>
