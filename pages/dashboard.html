<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMS | Dashboard</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* specific dashboard overrides */
        body {
            display: block;
            /* Override flex center */
        }

        .bg-image {
            opacity: 0.1;
            /* Dim background more for dashboard readability */
        }
    </style>
</head>

<body>

    <!-- Reuse Background -->
    <div class="bg-image" style="background-image: url('../assets/inventory_system_background.png');"></div>

    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="title" style="font-size: 1.5rem; text-align: left; margin-bottom: 2rem;">
                <i class="fa-solid fa-cube"></i> IMS Cloud
            </div>

            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-tab="dashboard">
                    <i class="fa-solid fa-chart-line"></i> Dashboard
                </a>

                <a href="#" class="nav-item" data-tab="purchase">
                    <i class="fa-solid fa-cart-shopping"></i> Purchase
                </a>
                <a href="#" class="nav-item" data-tab="sales">
                    <i class="fa-solid fa-cash-register"></i> Sales
                </a>
                <a href="#" class="nav-item" data-tab="expenses">
                    <i class="fa-solid fa-money-bill-wave"></i> Expenses
                </a>
                <a href="#" class="nav-item" data-tab="inventory">
                    <i class="fa-solid fa-boxes-stacked"></i> Inventory
                </a>
                <a href="#" class="nav-item" data-tab="reports">
                    <i class="fa-solid fa-file-invoice"></i> Reports
                </a>
                <!-- Admin Only -->
                <a href="#" class="nav-item hidden" id="adminTab" data-tab="admin">
                    <i class="fa-solid fa-users-gear"></i> Admin Panel
                </a>

                <div style="margin-top: auto;">
                    <a href="#" class="nav-item" id="logoutBtn">
                        <i class="fa-solid fa-right-from-bracket"></i> Logout
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                <h2 id="pageTitle" style="font-size: 1.75rem;">Dashboard</h2>
                <div class="user-profile" style="display: flex; align-items: center; gap: 1rem;">
                    <span id="userNameDisplay">User Name</span>
                    <div
                        style="width: 40px; height: 40px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                        <i class="fa-solid fa-user"></i>
                    </div>
                </div>
            </header>

            <!-- Dashboard View -->
            <section id="dashboard" class="view-section">
                <div class="stat-grid">
                    <div class="stat-card">
                        <h3>Total Stock Value</h3>
                        <div class="stat-value">Rs. 0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Sales</h3>
                        <div class="stat-value">Rs. 0</div>
                    </div>
                    <div class="stat-card">
                        <h3>Total Purchases</h3>
                        <div class="stat-value">Rs. 0</div>
                    </div>
                </div>

                <!-- Quick Actions Grid ("Small Boxes") -->
                <h3 style="margin-bottom: 1rem; color: #ddd; font-size: 1.1rem;">Quick Actions</h3>
                <div class="quick-actions-grid">
                    <div class="action-box" onclick="document.querySelector('[data-tab=purchase]').click()">
                        <div class="action-icon"><i class="fa-solid fa-cart-shopping"></i></div>
                        <div>New Purchase</div>
                    </div>
                    <div class="action-box" onclick="document.querySelector('[data-tab=sales]').click()">
                        <div class="action-icon" style="color: #22c55e;"><i class="fa-solid fa-cash-register"></i></div>
                        <div>New Sale</div>
                    </div>
                    <div class="action-box" onclick="document.querySelector('[data-tab=expenses]').click()">
                        <div class="action-icon" style="color: #f59e0b;"><i class="fa-solid fa-money-bill-wave"></i>
                        </div>
                        <div>Add Expense</div>
                    </div>
                    <div class="action-box" onclick="document.querySelector('[data-tab=inventory]').click()">
                        <div class="action-icon" style="color: #6366f1;"><i class="fa-solid fa-boxes-stacked"></i></div>
                        <div>View Inventory</div>
                    </div>
                    <div class="action-box" onclick="document.querySelector('[data-tab=reports]').click()">
                        <div class="action-icon" style="color: #a855f7;"><i class="fa-solid fa-file-invoice"></i></div>
                        <div>View Reports</div>
                    </div>
                </div>

                <!-- Dashboard Banner Position -->
                <div id="dashboardBannerContainer"
                    style="margin-top: 2rem; width: 100%; display: flex; justify-content: center;">
                    <!-- Injected via JS -->
                </div>
            </section>

            <!-- Inventory View -->
            <section id="inventory" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <h3>Available Inventory</h3>
                        <button class="btn" style="width: auto;" onclick="openModal('addItemModal')"><i
                                class="fa-solid fa-plus"></i> Add Item</button>
                    </div>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Category</th>
                                <th>Item Name</th>
                                <th>Brand</th>
                                <th>Model</th>
                                <th>Qty Available</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Purchase View -->
            <section id="purchase" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <h3>Purchase Entry</h3>
                    <form id="purchaseForm"
                        style="margin-top: 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>Item</label>
                            <select class="form-input" id="purItem"></select>
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" class="form-input" id="purQty">
                        </div>
                        <div class="form-group">
                            <label>Supplier</label>
                            <input type="text" class="form-input" id="purSupplier">
                        </div>
                        <div class="form-group">
                            <label>Cost Price</label>
                            <input type="number" class="form-input" id="purPrice">
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <button type="submit" class="btn">Record Purchase</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Sales View -->
            <section id="sales" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <h3>New Sale</h3>
                    <form id="salesForm"
                        style="margin-top: 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>Item</label>
                            <select class="form-input" id="saleItem"></select>
                        </div>
                        <div class="form-group">
                            <label>Quantity</label>
                            <input type="number" class="form-input" id="saleQty">
                        </div>
                        <div class="form-group">
                            <label>Customer Name</label>
                            <input type="text" class="form-input" id="saleCustomer">
                        </div>
                        <div class="form-group">
                            <label>Selling Price</label>
                            <input type="number" class="form-input" id="salePrice">
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <button type="submit" class="btn">Record Sale</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Expenses View -->
            <section id="expenses" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <h3>Record Expense</h3>
                    <form id="expenseForm"
                        style="margin-top: 1rem; display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div class="form-group">
                            <label>Expense Title</label>
                            <input type="text" class="form-input" id="expTitle" placeholder="e.g. Electricity Bill">
                        </div>
                        <div class="form-group">
                            <label>Category</label>
                            <select class="form-input" id="expCategory">
                                <option>Utilities</option>
                                <option>Rent</option>
                                <option>Salaries</option>
                                <option>Maintenance</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Amount</label>
                            <input type="number" class="form-input" id="expAmount">
                        </div>
                        <div class="form-group">
                            <label>Date</label>
                            <input type="date" class="form-input" id="expDate">
                        </div>
                        <div class="form-group" style="grid-column: span 2;">
                            <button type="submit" class="btn">Save Expense</button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Admin View -->
            <section id="admin" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <h3>Pending User Approvals</h3>
                    <div id="pendingUsersList">
                        <p>Loading...</p>
                    </div>
                </div>
            </section>

            <!-- Reports View -->
            <section id="reports" class="view-section hidden">
                <div class="glass-card" style="max-width: 100%;">
                    <h3>Generate Reports</h3>
                    <p>Select report type...</p>
                </div>
            </section>

        </main>
    </div>

    <!-- Modals -->
    <!-- Add Item Modal -->
    <div id="addItemModal" class="modal-overlay hidden">
        <div class="glass-card" style="max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 1.5rem;">
                <h3>Add New Inventory Item</h3>
                <button class="btn" style="width: auto; padding: 0.2rem 0.6rem; background: var(--error);"
                    onclick="closeModal('addItemModal')"><i class="fa-solid fa-xmark"></i></button>
            </div>

            <form id="addItemForm" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                <!-- Row 1: Date & Vendor -->
                <div class="form-group">
                    <label>Date</label>
                    <input type="date" class="form-input" id="invDate" readonly>
                </div>
                <div class="form-group">
                    <label>Vendor Name</label>
                    <input type="text" class="form-input" id="invVendor" placeholder="Vendor Name">
                </div>

                <!-- Row 2: Category & Item Name -->
                <div class="form-group">
                    <label>Category</label>
                    <input type="text" class="form-input" id="invCategory" list="categoryList"
                        placeholder="Select or Type">
                    <datalist id="categoryList">
                        <option value="Electronics">
                        <option value="Furniture">
                        <option value="Stationery">
                    </datalist>
                </div>
                <div class="form-group">
                    <label>Item Name</label>
                    <input type="text" class="form-input" id="invItemName" placeholder="Item Name">
                </div>

                <!-- Row 3: Brand & Model -->
                <div class="form-group">
                    <label>Brand</label>
                    <input type="text" class="form-input" id="invBrand" placeholder="Brand">
                </div>
                <div class="form-group">
                    <label>Model</label>
                    <input type="text" class="form-input" id="invModel" placeholder="Model">
                </div>

                <!-- Row 4: Qty & Price -->
                <div class="form-group">
                    <label>Quantity</label>
                    <input type="number" class="form-input" id="invQty" placeholder="0" oninput="calculateInvTotal()">
                </div>
                <div class="form-group">
                    <label>Price Per Unit</label>
                    <input type="number" class="form-input" id="invPrice" placeholder="0.00"
                        oninput="calculateInvTotal()">
                </div>

                <!-- Row 5: Total & Payment Mode -->
                <div class="form-group">
                    <label>Total Amount</label>
                    <input type="number" class="form-input" id="invTotal" readonly
                        style="background: rgba(255,255,255,0.05); color: #fbbf24; font-weight: bold;">
                </div>
                <div class="form-group">
                    <label>Payment Mode</label>
                    <select class="form-input" id="invPayMode">
                        <option value="Cash">Cash</option>
                        <option value="Cheque">Cheque</option>
                        <option value="Online">Online</option>
                        <option value="Credit">Credit (Unpaid)</option>
                    </select>
                </div>

                <!-- Row 6: Paid & Balance -->
                <div class="form-group">
                    <label>Amount Paid</label>
                    <input type="number" class="form-input" id="invPaid" placeholder="0.00"
                        oninput="calculateInvBalance()">
                </div>
                <div class="form-group">
                    <label>Balance Amount</label>
                    <input type="number" class="form-input" id="invBalance" readonly
                        style="background: rgba(255,255,255,0.05); color: #ef4444; font-weight: bold;">
                </div>

                <div class="form-group" style="grid-column: span 2; margin-top: 1rem;">
                    <button type="submit" class="btn">Save Item</button>
                </div>
            </form>
        </div>
    </div>

    <script src="../js/api.js"></script>
    <script src="../js/app.js"></script>
</body>

</html>